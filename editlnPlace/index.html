<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<!-- <div>这个人很懒，什么都没有留下</div> -->
<!-- 双击一下， 文字变为输入框 立即输入，回车 -->
<!-- - 事件
- 状态的改变 Document
- 本地存储
- 将这些整合起来 面向对象来封装处理 -->
<div id="profile"></div>
<script>
//在线编辑  首字母大写为类 封装它内部的实现细节
function EditInPlace(id, parent, value) {
    this.id = id
    this.value = value || 'default value'
    this.parentElement = document.getElementById(parent)
    this.createElements() //把节点显示到页面上
}
//
EditInPlace.prototype.attachEvents = function() {
    //this 指向实例过后的对象
    // var that = this;//保存一下当前this，防止下面覆盖
    this.saveButton.addEventListener('click',()=>{
        var text=this.fieldElement.value;
        // 本地缓存
        this.value=text;
        window.localStorage.setItem('profile',text);
        this.staticElement.innerText=text;
        this.convertToText();
    })
    this.cancelButton.addEventListener('click',()=>{
        this.convertToText();
    })
    this.staticElement.addEventListener('click',() =>{
        // console.log('小魔仙全身变')
        //箭头函数中的this会指向外层
        this.convertToEdit();
    },false)
}
EditInPlace.prototype.convertToEdit=function(){
        this.staticElement.style.display = 'none';
        this.fieldElement.style.display = 'inline';
        this.saveButton.style.display='inline';
        this.cancelButton.style.display='inline';
}
EditInPlace.prototype.convertToText=function(){
        this.staticElement.style.display = 'block';
        this.fieldElement.style.display = 'none';
        this.saveButton.style.display='none';
        this.cancelButton.style.display='none';
}
// 构造函数
EditInPlace.prototype.createElements = function(){
    // console.log('显示文本')
    this.containerElement = document.createElement('div')
    this.staticElement = document.createElement('span')
    this.staticElement.innerHTML = this.value    
    this.fieldElement = document.createElement('input')
    this.fieldElement.type = 'text'
    this.fieldElement.value = this.value
    this.fieldElement.style.display = 'none'
    
    this.saveButton=document.createElement('input');
    this.saveButton.type='button';
    this.saveButton.value='save';
    this.saveButton.style.display='none';
    this.cancelButton=document.createElement('input');
    this.cancelButton.type='button';
    this.cancelButton.value='cancel';
    this.cancelButton.style.display='none';

    this.containerElement.appendChild(this.fieldElement);  
    this.containerElement.appendChild(this.saveButton); 
    this.containerElement.appendChild(this.cancelButton);
    this.containerElement.appendChild(this.staticElement);
    this.parentElement.appendChild(this.containerElement);
    this.attachEvents()
}
function EditInPlace(id,parent,value){}
EditInPlace.prototype={
    createElement(){},//创建结点
    attachEvents(){},//管理所有的事件
    convertToText(){},
    convertToEdit(){},
    save(){},
    setValue(val){
        this.value=value;
        this.staticElement.innerText=value;
        localStorage.setItem('profile',value);

    },
    cancel(){},
    
}
window.onload=function(){
    var profile=localStorage.getItem('profile');
    var profileEditor = new EditInPlace('titleClassical','profile',profile);
}

</script>
</body>
</html>
